import{q as w,c as l,p as f,a as t,w as x,e as r,v as u,x as p,B as N,F as S,j as V,l as q,d as I,b as v,t as b,r as g,A as U,i as A,g as R,o as d}from"./index-BFw-5ybC.js";import{u as C}from"./advances-Bs1wD2gA.js";import{u as k}from"./trips-6R3CgoW9.js";import{u as B}from"./useToast-s_LeXPXK.js";import{P}from"./PageHeader-BOipoClw.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"form-card card"},M={class:"card-body"},F={class:"grid-2"},G={class:"form-group"},j={class:"input-with-prefix"},H={class:"form-group"},L={class:"grid-2"},z={class:"form-group"},J={class:"form-group"},K={class:"form-group"},O=["value"],Q={class:"form-group"},W={class:"form-actions"},X=["disabled"],Y={key:0,class:"loading-spinner",style:{width:"16px",height:"16px","border-width":"2px"}},Z={__name:"NewAdvanceView",setup($){const h=R(),y=C(),c=k(),a=B(),i=g(!1),m=g([]),o=U({amount:"",currency:"INR",paidThrough:"",reference:"",tripId:"",notes:""});async function T(){if(!o.amount||o.amount<=0)return a.error("Valid amount is required");if(!o.paidThrough)return a.error("Payment method is required");if(!o.tripId)return a.error("Trip is required");i.value=!0;try{await y.createAdvance({amount:o.amount,currency:o.currency,paidThrough:o.paidThrough,reference:o.reference,tripId:o.tripId,notes:o.notes}),a.success("Advance requested"),h.push("/app/advances")}catch(n){a.error(n.message)}finally{i.value=!1}}return w(async()=>{await c.fetchTrips(),m.value=c.trips.filter(n=>n.status==="pending"||n.status==="approved")}),(n,e)=>{const _=A("router-link");return d(),l("div",null,[f(P,{title:"New Advance",icon:"bi bi-credit-card-fill",subtitle:"Request a cash advance"}),t("div",E,[t("div",M,[t("form",{onSubmit:x(T,["prevent"])},[t("div",F,[t("div",G,[e[7]||(e[7]=t("label",{class:"form-label"},"Amount *",-1)),t("div",j,[e[6]||(e[6]=t("span",{class:"input-prefix"},"₹",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.amount=s),type:"number",step:"0.01",min:"0",class:"form-input pl-prefix",placeholder:"0.00",required:""},null,512),[[u,o.amount,void 0,{number:!0}]])])]),t("div",H,[e[9]||(e[9]=t("label",{class:"form-label"},"Currency",-1)),r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.currency=s),class:"form-input"},[...e[8]||(e[8]=[t("option",{value:"INR"},"INR — Indian Rupee",-1),t("option",{value:"USD"},"USD — US Dollar",-1),t("option",{value:"EUR"},"EUR — Euro",-1),t("option",{value:"GBP"},"GBP — British Pound",-1)])],512),[[p,o.currency]])])]),t("div",L,[t("div",z,[e[11]||(e[11]=t("label",{class:"form-label"},"Paid Through *",-1)),r(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.paidThrough=s),class:"form-input",required:""},[...e[10]||(e[10]=[N('<option value="" disabled data-v-5641c9ff>Select method</option><option value="cash" data-v-5641c9ff>Cash</option><option value="bank_transfer" data-v-5641c9ff>Bank Transfer</option><option value="cheque" data-v-5641c9ff>Cheque</option><option value="upi" data-v-5641c9ff>UPI</option><option value="credit_card" data-v-5641c9ff>Credit Card</option>',6)])],512),[[p,o.paidThrough]])]),t("div",J,[e[12]||(e[12]=t("label",{class:"form-label"},"Reference Number",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.reference=s),type:"text",class:"form-input",placeholder:"Transaction / cheque ref"},null,512),[[u,o.reference]])])]),t("div",K,[e[14]||(e[14]=t("label",{class:"form-label"},"Trip *",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.tripId=s),class:"form-input",required:""},[e[13]||(e[13]=t("option",{value:"",disabled:""},"Select trip",-1)),(d(!0),l(S,null,V(m.value,s=>(d(),l("option",{key:s.id,value:s.id},b(s.tripName||s.trip_name),9,O))),128))],512),[[p,o.tripId]])]),t("div",Q,[e[15]||(e[15]=t("label",{class:"form-label"},"Notes",-1)),r(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.notes=s),class:"form-input",rows:"3",placeholder:"Additional details about this advance"},null,512),[[u,o.notes]])]),t("div",W,[f(_,{to:"/app/advances",class:"btn btn-outline"},{default:q(()=>[...e[16]||(e[16]=[v("Cancel",-1)])]),_:1}),t("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(d(),l("span",Y)):I("",!0),v(" "+b(i.value?"Saving…":"Request Advance"),1)],8,X)])],32)])])])}}},ie=D(Z,[["__scopeId","data-v-5641c9ff"]]);export{ie as default};
