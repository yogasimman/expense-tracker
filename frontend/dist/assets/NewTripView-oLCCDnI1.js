import{u as B,q as P,s as Y,c as a,p as f,a as e,w as O,e as n,v as d,f as z,x as j,F as y,j as g,d as m,n as c,y as L,t as b,l as U,z as h,b as S,r as N,A as $,i as G,g as J,o as i}from"./index-BFw-5ybC.js";import{u as K}from"./trips-6R3CgoW9.js";import{u as Q}from"./useToast-s_LeXPXK.js";import{P as W}from"./PageHeader-BOipoClw.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"trip-container"},tt={class:"form-group"},et={key:0,class:"form-group"},st=["value"],ot={class:"form-group"},lt={class:"travel-type-options"},rt={class:"itinerary-form"},at=["disabled"],nt={key:0,class:"transport-section"},it={class:"entry-grid"},dt={class:"form-group"},pt=["onUpdate:modelValue"],ut={class:"form-group"},mt=["onUpdate:modelValue"],bt={class:"form-group"},ft=["onUpdate:modelValue"],ct={class:"form-group"},vt=["onUpdate:modelValue"],yt={class:"form-group"},gt=["onUpdate:modelValue"],Ut=["onClick"],kt=["disabled"],Tt={key:0,class:"transport-section"},Vt={class:"entry-grid entry-grid-4"},Dt={class:"form-group"},At=["onUpdate:modelValue"],_t={class:"form-group"},Ct=["onUpdate:modelValue"],ht={class:"form-group"},xt=["onUpdate:modelValue"],wt={class:"form-group"},Ft=["onUpdate:modelValue"],Lt=["onClick"],Nt=["disabled"],Et={key:0,class:"transport-section"},Ht={class:"entry-grid entry-grid-4"},St={class:"form-group"},$t=["onUpdate:modelValue"],Rt={class:"form-group"},qt=["onUpdate:modelValue"],It={class:"form-group"},Mt=["onUpdate:modelValue"],Bt={class:"form-group"},Pt=["onUpdate:modelValue"],Yt=["onClick"],Ot={class:"transport-option"},zt={key:0,class:"transport-section"},jt={class:"entry-grid entry-grid-4"},Gt={class:"form-group"},Jt=["onUpdate:modelValue"],Kt={class:"form-group"},Qt=["onUpdate:modelValue"],Wt={class:"form-group"},Xt=["onUpdate:modelValue"],Zt={class:"form-group"},te=["onUpdate:modelValue"],ee=["onClick"],se={key:0,class:"result-msg"},oe={class:"form-actions"},le=["disabled"],re={key:0,class:"spinner",style:{width:"16px",height:"16px","border-width":"2px"}},ae={__name:"NewTripView",setup(ne){const R=J(),q=K(),x=B(),w=Q(),v=N(!1),E=N(""),H=N([]),p=$({flights:!1,buses:!1,trains:!1,cabs:!1}),o=$({tripName:"",travelType:"domestic",selectedUsers:[],itinerary:{flights:[{departFrom:"",arriveAt:"",departureDate:"",returnDate:"",description:""}],buses:[{departFrom:"",arriveAt:"",departureDate:"",description:""}],trains:[{departFrom:"",arriveAt:"",departureDate:"",description:""}],cabs:[{pickUpLocation:"",dropOffLocation:"",pickUpDate:"",description:""}]}});function k(l){p[l]=!p[l]}function F(){o.travelType==="local"&&(p.flights=!1,p.buses=!1,p.trains=!1)}function T(l){const t={flights:{departFrom:"",arriveAt:"",departureDate:"",returnDate:"",description:""},buses:{departFrom:"",arriveAt:"",departureDate:"",description:""},trains:{departFrom:"",arriveAt:"",departureDate:"",description:""},cabs:{pickUpLocation:"",dropOffLocation:"",pickUpDate:"",description:""}};o.itinerary[l].push({...t[l]})}function V(l,t){o.itinerary[l].splice(t,1)}function D(l,t){l.style.overflow="hidden",l.style.maxHeight="0",l.offsetHeight,l.style.transition="max-height 0.35s ease",l.style.maxHeight=l.scrollHeight+"px",setTimeout(t,350)}function A(l){l.style.maxHeight="none",l.style.overflow="",l.style.transition=""}function _(l,t){l.style.overflow="hidden",l.style.maxHeight=l.scrollHeight+"px",l.offsetHeight,l.style.transition="max-height 0.3s ease",l.style.maxHeight="0",setTimeout(t,300)}function C(l){l.style.maxHeight="",l.style.overflow="",l.style.transition=""}async function I(){if(!o.tripName.trim())return w.error("Trip name is required");v.value=!0;try{const l={tripName:o.tripName,travelType:o.travelType,itinerary:{flights:p.flights?o.itinerary.flights:[],buses:p.buses?o.itinerary.buses:[],trains:p.trains?o.itinerary.trains:[],cabs:p.cabs?o.itinerary.cabs:[]}};x.isAdmin&&o.selectedUsers.length&&(l.userId=o.selectedUsers),await q.createTrip(l),w.success("Trip created successfully"),R.push("/app/trips")}catch(l){w.error(l.message)}finally{v.value=!1}}return P(async()=>{if(x.isAdmin)try{H.value=await Y.getUsers()}catch(l){console.error("Failed to load users:",l)}}),(l,t)=>{const M=G("router-link");return i(),a("div",null,[f(W,{title:"New Trip",icon:"bi bi-briefcase",subtitle:"Create a new trip request"}),e("div",Z,[e("form",{onSubmit:O(I,["prevent"])},[e("div",tt,[t[13]||(t[13]=e("label",{class:"form-label"},"Trip Name *",-1)),n(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.tripName=s),type:"text",class:"form-input",placeholder:"eg: Trip to New York",required:""},null,512),[[d,o.tripName]])]),z(x).isAdmin?(i(),a("div",et,[t[14]||(t[14]=e("label",{class:"form-label"},"Select Users",-1)),n(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.selectedUsers=s),multiple:"",class:"form-select user-select"},[(i(!0),a(y,null,g(H.value,s=>(i(),a("option",{key:s.id,value:s.id},b(s.name)+" ("+b(s.email)+")",9,st))),128))],512),[[j,o.selectedUsers]]),t[15]||(t[15]=e("span",{class:"form-hint"},"Hold Ctrl/Cmd to select multiple users.",-1))])):m("",!0),e("div",ot,[t[22]||(t[22]=e("label",{class:"form-label"},"Travel Type *",-1)),e("div",lt,[e("label",{class:c(["travel-type-radio",{active:o.travelType==="local"}])},[n(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=s=>o.travelType=s),value:"local",onChange:F},null,544),[[L,o.travelType]]),t[16]||(t[16]=e("span",{class:"radio-label"},"Local",-1)),t[17]||(t[17]=e("span",{class:"radio-desc"},"You are creating this request for a trip within your company locality.",-1))],2),e("label",{class:c(["travel-type-radio",{active:o.travelType==="domestic"}])},[n(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=s=>o.travelType=s),value:"domestic",onChange:F},null,544),[[L,o.travelType]]),t[18]||(t[18]=e("span",{class:"radio-label"},"Domestic",-1)),t[19]||(t[19]=e("span",{class:"radio-desc"},"You are creating this request for a trip within your home country.",-1))],2),e("label",{class:c(["travel-type-radio",{active:o.travelType==="international"}])},[n(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=s=>o.travelType=s),value:"international",onChange:F},null,544),[[L,o.travelType]]),t[20]||(t[20]=e("span",{class:"radio-label"},"International",-1)),t[21]||(t[21]=e("span",{class:"radio-desc"},"You are creating this request for a trip outside your home country.",-1))],2)])]),t[53]||(t[53]=e("div",{class:"itinerary-header"},"TRIP ITINERARY",-1)),e("div",rt,[e("div",{class:c(["transport-option",{disabled:o.travelType==="local"}])},[e("button",{type:"button",class:"toggle-btn",onClick:t[5]||(t[5]=s=>k("flights")),disabled:o.travelType==="local"},b(p.flights?"−":"+"),9,at),t[23]||(t[23]=e("i",{class:"bi bi-airplane transport-icon"},null,-1)),t[24]||(t[24]=e("span",null,"Flight",-1))],2),f(h,{css:!1,onEnter:D,onAfterEnter:A,onLeave:_,onAfterLeave:C},{default:U(()=>[p.flights&&o.travelType!=="local"?(i(),a("div",nt,[(i(!0),a(y,null,g(o.itinerary.flights,(s,u)=>(i(),a("div",{key:"f"+u,class:"transport-entry"},[e("div",it,[e("div",dt,[t[25]||(t[25]=e("label",{class:"form-label form-label-sm"},"Depart From *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departFrom=r,class:"form-input"},null,8,pt),[[d,s.departFrom]])]),e("div",ut,[t[26]||(t[26]=e("label",{class:"form-label form-label-sm"},"Arrive At *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.arriveAt=r,class:"form-input"},null,8,mt),[[d,s.arriveAt]])]),e("div",bt,[t[27]||(t[27]=e("label",{class:"form-label form-label-sm"},"Departure Date *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departureDate=r,type:"date",class:"form-input"},null,8,ft),[[d,s.departureDate]])]),e("div",ct,[t[28]||(t[28]=e("label",{class:"form-label form-label-sm"},"Return Date *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.returnDate=r,type:"date",class:"form-input"},null,8,vt),[[d,s.returnDate]])]),e("div",yt,[t[29]||(t[29]=e("label",{class:"form-label form-label-sm"},"Description",-1)),n(e("input",{"onUpdate:modelValue":r=>s.description=r,class:"form-input",placeholder:"Description"},null,8,gt),[[d,s.description]])])]),u>0?(i(),a("button",{key:0,type:"button",class:"remove-entry-btn",onClick:r=>V("flights",u)},[...t[30]||(t[30]=[e("i",{class:"bi bi-dash-lg"},null,-1)])],8,Ut)):m("",!0)]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm add-entry-btn",onClick:t[6]||(t[6]=s=>T("flights"))}," + Add Another Flight ")])):m("",!0)]),_:1}),e("div",{class:c(["transport-option",{disabled:o.travelType==="local"}])},[e("button",{type:"button",class:"toggle-btn",onClick:t[7]||(t[7]=s=>k("buses")),disabled:o.travelType==="local"},b(p.buses?"−":"+"),9,kt),t[31]||(t[31]=e("i",{class:"bi bi-bus-front transport-icon"},null,-1)),t[32]||(t[32]=e("span",null,"Bus",-1))],2),f(h,{css:!1,onEnter:D,onAfterEnter:A,onLeave:_,onAfterLeave:C},{default:U(()=>[p.buses&&o.travelType!=="local"?(i(),a("div",Tt,[(i(!0),a(y,null,g(o.itinerary.buses,(s,u)=>(i(),a("div",{key:"b"+u,class:"transport-entry"},[e("div",Vt,[e("div",Dt,[t[33]||(t[33]=e("label",{class:"form-label form-label-sm"},"Depart From *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departFrom=r,class:"form-input"},null,8,At),[[d,s.departFrom]])]),e("div",_t,[t[34]||(t[34]=e("label",{class:"form-label form-label-sm"},"Arrive At *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.arriveAt=r,class:"form-input"},null,8,Ct),[[d,s.arriveAt]])]),e("div",ht,[t[35]||(t[35]=e("label",{class:"form-label form-label-sm"},"Departure Date *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departureDate=r,type:"date",class:"form-input"},null,8,xt),[[d,s.departureDate]])]),e("div",wt,[t[36]||(t[36]=e("label",{class:"form-label form-label-sm"},"Description",-1)),n(e("input",{"onUpdate:modelValue":r=>s.description=r,class:"form-input",placeholder:"Description"},null,8,Ft),[[d,s.description]])])]),u>0?(i(),a("button",{key:0,type:"button",class:"remove-entry-btn",onClick:r=>V("buses",u)},[...t[37]||(t[37]=[e("i",{class:"bi bi-dash-lg"},null,-1)])],8,Lt)):m("",!0)]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm add-entry-btn",onClick:t[8]||(t[8]=s=>T("buses"))}," + Add Another Bus ")])):m("",!0)]),_:1}),e("div",{class:c(["transport-option",{disabled:o.travelType==="local"}])},[e("button",{type:"button",class:"toggle-btn",onClick:t[9]||(t[9]=s=>k("trains")),disabled:o.travelType==="local"},b(p.trains?"−":"+"),9,Nt),t[38]||(t[38]=e("i",{class:"bi bi-train-front transport-icon"},null,-1)),t[39]||(t[39]=e("span",null,"Train",-1))],2),f(h,{css:!1,onEnter:D,onAfterEnter:A,onLeave:_,onAfterLeave:C},{default:U(()=>[p.trains&&o.travelType!=="local"?(i(),a("div",Et,[(i(!0),a(y,null,g(o.itinerary.trains,(s,u)=>(i(),a("div",{key:"t"+u,class:"transport-entry"},[e("div",Ht,[e("div",St,[t[40]||(t[40]=e("label",{class:"form-label form-label-sm"},"Depart From *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departFrom=r,class:"form-input"},null,8,$t),[[d,s.departFrom]])]),e("div",Rt,[t[41]||(t[41]=e("label",{class:"form-label form-label-sm"},"Arrive At *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.arriveAt=r,class:"form-input"},null,8,qt),[[d,s.arriveAt]])]),e("div",It,[t[42]||(t[42]=e("label",{class:"form-label form-label-sm"},"Departure Date *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.departureDate=r,type:"date",class:"form-input"},null,8,Mt),[[d,s.departureDate]])]),e("div",Bt,[t[43]||(t[43]=e("label",{class:"form-label form-label-sm"},"Description",-1)),n(e("input",{"onUpdate:modelValue":r=>s.description=r,class:"form-input",placeholder:"Description"},null,8,Pt),[[d,s.description]])])]),u>0?(i(),a("button",{key:0,type:"button",class:"remove-entry-btn",onClick:r=>V("trains",u)},[...t[44]||(t[44]=[e("i",{class:"bi bi-dash-lg"},null,-1)])],8,Yt)):m("",!0)]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm add-entry-btn",onClick:t[10]||(t[10]=s=>T("trains"))}," + Add Another Train ")])):m("",!0)]),_:1}),e("div",Ot,[e("button",{type:"button",class:"toggle-btn",onClick:t[11]||(t[11]=s=>k("cabs"))},b(p.cabs?"−":"+"),1),t[45]||(t[45]=e("i",{class:"bi bi-taxi-front transport-icon"},null,-1)),t[46]||(t[46]=e("span",null,"Cab",-1))]),f(h,{css:!1,onEnter:D,onAfterEnter:A,onLeave:_,onAfterLeave:C},{default:U(()=>[p.cabs?(i(),a("div",zt,[(i(!0),a(y,null,g(o.itinerary.cabs,(s,u)=>(i(),a("div",{key:"c"+u,class:"transport-entry"},[e("div",jt,[e("div",Gt,[t[47]||(t[47]=e("label",{class:"form-label form-label-sm"},"Pick-up Location *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.pickUpLocation=r,class:"form-input"},null,8,Jt),[[d,s.pickUpLocation]])]),e("div",Kt,[t[48]||(t[48]=e("label",{class:"form-label form-label-sm"},"Drop-off Location *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.dropOffLocation=r,class:"form-input"},null,8,Qt),[[d,s.dropOffLocation]])]),e("div",Wt,[t[49]||(t[49]=e("label",{class:"form-label form-label-sm"},"Pick-up Date *",-1)),n(e("input",{"onUpdate:modelValue":r=>s.pickUpDate=r,type:"date",class:"form-input"},null,8,Xt),[[d,s.pickUpDate]])]),e("div",Zt,[t[50]||(t[50]=e("label",{class:"form-label form-label-sm"},"Description",-1)),n(e("input",{"onUpdate:modelValue":r=>s.description=r,class:"form-input",placeholder:"Description"},null,8,te),[[d,s.description]])])]),u>0?(i(),a("button",{key:0,type:"button",class:"remove-entry-btn",onClick:r=>V("cabs",u)},[...t[51]||(t[51]=[e("i",{class:"bi bi-dash-lg"},null,-1)])],8,ee)):m("",!0)]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm add-entry-btn",onClick:t[12]||(t[12]=s=>T("cabs"))}," + Add Another Cab ")])):m("",!0)]),_:1}),E.value?(i(),a("p",se,b(E.value),1)):m("",!0)]),e("div",oe,[f(M,{to:"/app/trips",class:"btn btn-outline"},{default:U(()=>[...t[52]||(t[52]=[S("Cancel",-1)])]),_:1}),e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(i(),a("span",re)):m("",!0),S(" "+b(v.value?"Saving…":"Save and Submit"),1)],8,le)])],32)])])}}},be=X(ae,[["__scopeId","data-v-b778be38"]]);export{be as default};
