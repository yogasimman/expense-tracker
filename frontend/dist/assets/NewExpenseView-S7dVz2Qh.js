import{A as D,q as U,c as a,p as b,a as t,w as E,e as r,v as p,x as d,F as g,j as x,f as N,l as T,d as q,b as y,t as m,r as w,i as C,g as R,o as l}from"./index-BFw-5ybC.js";import{u as k}from"./expenses-68LlJUI8.js";import{u as B}from"./categories-Beg3pEtd.js";import{u as P}from"./trips-6R3CgoW9.js";import{u as M}from"./useToast-s_LeXPXK.js";import{P as A}from"./PageHeader-BOipoClw.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"form-card card"},H={class:"card-body"},O={class:"grid-2"},j={class:"form-group"},L={class:"form-group"},z={class:"input-with-prefix"},J={class:"grid-2"},K={class:"form-group"},Q={class:"form-group"},W={class:"grid-2"},X={class:"form-group"},Y=["value"],Z={class:"form-group"},$=["value"],h={class:"form-group"},ee={class:"form-actions"},te=["disabled"],se={key:0,class:"loading-spinner",style:{width:"16px",height:"16px","border-width":"2px"}},oe={__name:"NewExpenseView",setup(re){const S=R(),_=k(),f=B(),c=P(),i=M(),n=w(!1),v=w([]),s=D({title:"",amount:"",currency:"INR",expenseDate:new Date().toISOString().split("T")[0],category:"",tripId:"",description:""});async function V(){if(!s.title.trim())return i.error("Title is required");if(!s.amount||s.amount<=0)return i.error("Valid amount is required");if(!s.category)return i.error("Category is required");if(!s.tripId)return i.error("Trip is required");n.value=!0;try{await _.createExpense({expenseTitle:s.title,amount:s.amount,currency:s.currency,date:s.expenseDate,categoryId:s.category,tripId:s.tripId,description:s.description}),i.success("Expense created"),S.push("/app/expenses")}catch(u){i.error(u.message)}finally{n.value=!1}}return U(async()=>{await Promise.all([f.fetchCategories(),c.fetchTrips()]),v.value=c.trips.filter(u=>u.status==="approved")}),(u,e)=>{const I=C("router-link");return l(),a("div",null,[b(A,{title:"New Expense",icon:"bi bi-receipt-cutoff",subtitle:"Record a new expense"}),t("div",G,[t("div",H,[t("form",{onSubmit:E(V,["prevent"])},[t("div",O,[t("div",j,[e[7]||(e[7]=t("label",{class:"form-label"},"Title *",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.title=o),type:"text",class:"form-input",placeholder:"e.g. Hotel stay — Mumbai",required:""},null,512),[[p,s.title]])]),t("div",L,[e[9]||(e[9]=t("label",{class:"form-label"},"Amount *",-1)),t("div",z,[e[8]||(e[8]=t("span",{class:"input-prefix"},"₹",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.amount=o),type:"number",step:"0.01",min:"0",class:"form-input pl-prefix",placeholder:"0.00",required:""},null,512),[[p,s.amount,void 0,{number:!0}]])])])]),t("div",J,[t("div",K,[e[11]||(e[11]=t("label",{class:"form-label"},"Currency",-1)),r(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.currency=o),class:"form-input"},[...e[10]||(e[10]=[t("option",{value:"INR"},"INR — Indian Rupee",-1),t("option",{value:"USD"},"USD — US Dollar",-1),t("option",{value:"EUR"},"EUR — Euro",-1),t("option",{value:"GBP"},"GBP — British Pound",-1)])],512),[[d,s.currency]])]),t("div",Q,[e[12]||(e[12]=t("label",{class:"form-label"},"Date *",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.expenseDate=o),type:"date",class:"form-input",required:""},null,512),[[p,s.expenseDate]])])]),t("div",W,[t("div",X,[e[14]||(e[14]=t("label",{class:"form-label"},"Category *",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.category=o),class:"form-input",required:""},[e[13]||(e[13]=t("option",{value:"",disabled:""},"Select category",-1)),(l(!0),a(g,null,x(N(f).categories,o=>(l(),a("option",{key:o.id,value:o.name},m(o.name),9,Y))),128))],512),[[d,s.category]])]),t("div",Z,[e[16]||(e[16]=t("label",{class:"form-label"},"Trip *",-1)),r(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.tripId=o),class:"form-input",required:""},[e[15]||(e[15]=t("option",{value:"",disabled:""},"Select trip",-1)),(l(!0),a(g,null,x(v.value,o=>(l(),a("option",{key:o.id,value:o.id},m(o.tripName||o.trip_name),9,$))),128))],512),[[d,s.tripId]])])]),t("div",h,[e[17]||(e[17]=t("label",{class:"form-label"},"Description",-1)),r(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.description=o),class:"form-input",rows:"3",placeholder:"Optional details about this expense"},null,512),[[p,s.description]])]),t("div",ee,[b(I,{to:"/app/expenses",class:"btn btn-outline"},{default:T(()=>[...e[18]||(e[18]=[y("Cancel",-1)])]),_:1}),t("button",{type:"submit",class:"btn btn-primary",disabled:n.value},[n.value?(l(),a("span",se)):q("",!0),y(" "+m(n.value?"Saving…":"Create Expense"),1)],8,te)])],32)])])])}}},me=F(oe,[["__scopeId","data-v-6aa25998"]]);export{me as default};
